!function(){"use strict";angular.module("wu.masonry",[]).controller("MasonryCtrl",["$scope","$element","$timeout",function(e,n,r){function o(e){e.addClass("loaded")}var a={},t=[],s=!1,i=this,d=null;this.preserveOrder=!1,this.loadImages=!0,this.scheduleMasonryOnce=function(){var e=arguments,n=t.filter(function(n){return n[0]===e[0]}).length>0;n||this.scheduleMasonry.apply(null,arguments)},this.scheduleMasonry=function(){d&&r.cancel(d),t.push([].slice.call(arguments)),d=r(function(){s||(t.forEach(function(e){n.masonry.apply(n,e)}),t=[])},30)},this.addBrick=function(e,r,t){function d(){0===Object.keys(a).length&&n.masonry("resize"),void 0===a[t]&&(a[t]=!0,o(r),n.masonry(e,r,!0))}function c(){i.scheduleMasonryOnce("layout")}s||(i.loadImages?i.preserveOrder?(d(),r.imagesLoaded(c)):r.imagesLoaded(function(){d(),c()}):(d(),c()))},this.removeBrick=function(e,r){s||(delete a[e],n.masonry("remove",r),this.scheduleMasonryOnce("layout"))},this.destroy=function(){s=!0,n.data("masonry")&&n.masonry("destroy"),e.$emit("masonry.destroyed"),a={}},this.reload=function(){n.masonry(),e.$emit("masonry.reloaded")}}]).directive("masonry",function(){return{restrict:"AE",controller:"MasonryCtrl",link:{pre:function(e,n,r,o){var a=e.$eval(r.masonry||r.masonryOptions),t=angular.extend({itemSelector:r.itemSelector||".masonry-brick",columnWidth:parseInt(r.columnWidth,10)||r.columnWidth},a||{});n.masonry(t),e.masonryContainer=n[0];var s=e.$eval(r.loadImages);o.loadImages=s!==!1;var i=e.$eval(r.preserveOrder);o.preserveOrder=i!==!1&&void 0!==r.preserveOrder;var d=e.$eval(r.reloadOnShow);d!==!1&&void 0!==r.reloadOnShow&&e.$watch(function(){return n.prop("offsetParent")},function(e,n){e&&!n&&o.reload()});var c=e.$eval(r.reloadOnResize);c!==!1&&void 0!==r.reloadOnResize&&e.$watch("masonryContainer.offsetWidth",function(e,n){e!=n&&o.reload()}),e.$emit("masonry.created",n),e.$on("$destroy",o.destroy)}}}}).directive("masonryBrick",function(){return{restrict:"AC",require:"^masonry",scope:!0,link:{pre:function(e,n,r,o){var a,t=e.$id,s=e.$eval(r.prepend),i=s?"prepended":"appended";o.addBrick(i,n,t),n.on("$destroy",function(){o.removeBrick(t,n)}),e.$on("masonry.reload",function(){o.scheduleMasonryOnce("reloadItems"),o.scheduleMasonryOnce("layout")}),e.$watch("$index",function(){void 0!==a&&a!==e.$index&&(o.scheduleMasonryOnce("reloadItems"),o.scheduleMasonryOnce("layout")),a=e.$index})}}}})}();